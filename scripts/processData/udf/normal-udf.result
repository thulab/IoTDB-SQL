-- [1]7:create function my_compare as "com.timecho.udf.normal.TwoVariables"
STRICT{
PASS
}
-- [1]10:create timeseries root.udf.d1.s1 with datatype=int32
STRICT{
PASS
}
-- [1]11:create timeseries root.udf.d1.s2 with datatype=int64
STRICT{
PASS
}
-- [1]12:create timeseries root.udf.d1.s3 with datatype=float
STRICT{
PASS
}
-- [1]13:create timeseries root.udf.d1.s4 with datatype=double
STRICT{
PASS
}
-- [1]14:create timeseries root.udf.d1.s5 with datatype=boolean
STRICT{
PASS
}
-- [1]15:create timeseries root.udf.d1.s6 with datatype=text
STRICT{
PASS
}
-- [1]16:create timeseries root.udf.d1.s7 with datatype=int32
STRICT{
PASS
}
-- [1]18:insert into root.udf.d1(time, s1,s2,s3,s4,s5,s6) values (1,1,1,5,7,0,9),(2,2,4,4,8,1,1),(3,2,43,4,4,1,1),(4,2,4,6,0,0,1),(5,2,4,4,8,0,0)
STRICT{
0
}

Elapsed Time: 0.0.82

-- [1]21:select * from root.udf.d1
STRICT{
Time(TIME)      |root.udf.d1.s3(FLOAT)      |root.udf.d1.s4(DOUBLE)      |root.udf.d1.s5(BOOLEAN)      |root.udf.d1.s6(TEXT)      |root.udf.d1.s7(INT32)      |root.udf.d1.s1(INT32)      |root.udf.d1.s2(INT64)      |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1               |5.0                        |7.0                         |false                        |9                         |null                       |1                          |1                          |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2               |4.0                        |8.0                         |true                         |1                         |null                       |2                          |4                          |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3               |4.0                        |4.0                         |true                         |1                         |null                       |2                          |43                         |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4               |6.0                        |0.0                         |false                        |1                         |null                       |2                          |4                          |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5               |4.0                        |8.0                         |false                        |0                         |null                       |2                          |4                          |
总数目：5
}

Elapsed Time: 0.0.39

-- [1]23:select my_compare(s1,s7) from root.udf.d1
STRICT{
Time(TIME)      |my_compare(root.udf.d1.s1, root.udf.d1.s7)(BOOLEAN)      |
-------------------------------------------------------------------------
1               |false                                                    |
-------------------------------------------------------------------------
2               |false                                                    |
-------------------------------------------------------------------------
3               |false                                                    |
-------------------------------------------------------------------------
4               |false                                                    |
-------------------------------------------------------------------------
5               |false                                                    |
总数目：5
}

Elapsed Time: 0.0.26

-- [1]25:select my_compare(s1,s2) from root.udf.d1
STRICT{
Time(TIME)      |my_compare(root.udf.d1.s1, root.udf.d1.s2)(BOOLEAN)      |
-------------------------------------------------------------------------
1               |true                                                     |
-------------------------------------------------------------------------
2               |false                                                    |
-------------------------------------------------------------------------
3               |false                                                    |
-------------------------------------------------------------------------
4               |false                                                    |
-------------------------------------------------------------------------
5               |false                                                    |
总数目：5
}

Elapsed Time: 0.0.18

-- [1]26:select s1,s2,my_compare(s1,s2) from root.udf.d1
STRICT{
Time(TIME)      |root.udf.d1.s1(INT32)      |root.udf.d1.s2(INT64)      |my_compare(root.udf.d1.s1, root.udf.d1.s2)(BOOLEAN)      |
-------------------------------------------------------------------------------------------------------------------------------
1               |1                          |1                          |true                                                     |
-------------------------------------------------------------------------------------------------------------------------------
2               |2                          |4                          |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------
3               |2                          |43                         |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------
4               |2                          |4                          |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------
5               |2                          |4                          |false                                                    |
总数目：5
}

Elapsed Time: 0.0.10
-- [1]28:select my_compare(*) from root.udf.d1
STRICT{
SQLSTATE : 301: Index out of bound error!
}

-- [1]30:select my_compare(s1, *) from root.udf.d1
STRICT{
Time(TIME)      |my_compare(root.udf.d1.s1, root.udf.d1.s3)(BOOLEAN)      |my_compare(root.udf.d1.s1, root.udf.d1.s4)(BOOLEAN)      |my_compare(root.udf.d1.s1, root.udf.d1.s5)(BOOLEAN)      |my_compare(root.udf.d1.s1, root.udf.d1.s6)(BOOLEAN)      |my_compare(root.udf.d1.s1, root.udf.d1.s7)(BOOLEAN)      |my_compare(root.udf.d1.s1, root.udf.d1.s1)(BOOLEAN)      |my_compare(root.udf.d1.s1, root.udf.d1.s2)(BOOLEAN)      |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |true                                                     |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
总数目：5
}

Elapsed Time: 0.0.43

-- [1]31:select *, my_compare(s1,s2) from root.udf.d1
STRICT{
Time(TIME)      |root.udf.d1.s3(FLOAT)      |root.udf.d1.s4(DOUBLE)      |root.udf.d1.s5(BOOLEAN)      |root.udf.d1.s6(TEXT)      |root.udf.d1.s7(INT32)      |root.udf.d1.s1(INT32)      |root.udf.d1.s2(INT64)      |my_compare(root.udf.d1.s1, root.udf.d1.s2)(BOOLEAN)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1               |5.0                        |7.0                         |false                        |9                         |null                       |1                          |1                          |true                                                     |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2               |4.0                        |8.0                         |true                         |1                         |null                       |2                          |4                          |false                                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3               |4.0                        |4.0                         |true                         |1                         |null                       |2                          |43                         |false                                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4               |6.0                        |0.0                         |false                        |1                         |null                       |2                          |4                          |false                                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5               |4.0                        |8.0                         |false                        |0                         |null                       |2                          |4                          |false                                                    |
总数目：5
}

Elapsed Time: 0.0.61
-- [1]32:select *, my_compare(*) from root.udf.d1
STRICT{
SQLSTATE : 301: Index out of bound error!
EXPECT:PASS
}
-- [1]33:select s1, my_compare(*) from root.udf.d1
STRICT{
SQLSTATE : 301: Index out of bound error!
EXPECT:PASS
}
-- [1]36:create aligned timeseries root.udf.d2 (s1 int32, s2 int64, s3 float, s4 double, s5 boolean, s6 text, s7 int32)
STRICT{
PASS
}
-- [1]37:insert into root.udf.d2(time, s1,s2,s3,s4,s5,s6) aligned values (1,1,1,5,7,0,9),(2,2,4,4,8,1,1),(3,2,43,4,4,1,1),(4,2,4,6,0,0,1),(5,2,4,4,8,0,0)
STRICT{
0
}

Elapsed Time: 0.0.146

-- [1]39:select * from root.udf.d2
STRICT{
Time(TIME)      |root.udf.d2.s3(FLOAT)      |root.udf.d2.s4(DOUBLE)      |root.udf.d2.s5(BOOLEAN)      |root.udf.d2.s6(TEXT)      |root.udf.d2.s7(INT32)      |root.udf.d2.s1(INT32)      |root.udf.d2.s2(INT64)      |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1               |5.0                        |7.0                         |false                        |9                         |null                       |1                          |1                          |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2               |4.0                        |8.0                         |true                         |1                         |null                       |2                          |4                          |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3               |4.0                        |4.0                         |true                         |1                         |null                       |2                          |43                         |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4               |6.0                        |0.0                         |false                        |1                         |null                       |2                          |4                          |
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5               |4.0                        |8.0                         |false                        |0                         |null                       |2                          |4                          |
总数目：5
}

Elapsed Time: 0.0.57

-- [1]41:select my_compare(s1,s7) from root.udf.d2
STRICT{
Time(TIME)      |my_compare(root.udf.d2.s1, root.udf.d2.s7)(BOOLEAN)      |
-------------------------------------------------------------------------
1               |false                                                    |
-------------------------------------------------------------------------
2               |false                                                    |
-------------------------------------------------------------------------
3               |false                                                    |
-------------------------------------------------------------------------
4               |false                                                    |
-------------------------------------------------------------------------
5               |false                                                    |
总数目：5
}

Elapsed Time: 0.0.20

-- [1]43:select my_compare(s1,s2) from root.udf.d2
STRICT{
Time(TIME)      |my_compare(root.udf.d2.s1, root.udf.d2.s2)(BOOLEAN)      |
-------------------------------------------------------------------------
1               |true                                                     |
-------------------------------------------------------------------------
2               |false                                                    |
-------------------------------------------------------------------------
3               |false                                                    |
-------------------------------------------------------------------------
4               |false                                                    |
-------------------------------------------------------------------------
5               |false                                                    |
总数目：5
}

Elapsed Time: 0.0.7

-- [1]44:select my_compare(s1,s2),s1,s2 from root.udf.d1
STRICT{
Time(TIME)      |my_compare(root.udf.d1.s1, root.udf.d1.s2)(BOOLEAN)      |root.udf.d1.s1(INT32)      |root.udf.d1.s2(INT64)      |
-------------------------------------------------------------------------------------------------------------------------------
1               |true                                                     |1                          |1                          |
-------------------------------------------------------------------------------------------------------------------------------
2               |false                                                    |2                          |4                          |
-------------------------------------------------------------------------------------------------------------------------------
3               |false                                                    |2                          |43                         |
-------------------------------------------------------------------------------------------------------------------------------
4               |false                                                    |2                          |4                          |
-------------------------------------------------------------------------------------------------------------------------------
5               |false                                                    |2                          |4                          |
总数目：5
}

Elapsed Time: 0.0.13

-- [1]46:select my_compare(s1, *) from root.udf.d2
STRICT{
Time(TIME)      |my_compare(root.udf.d2.s1, root.udf.d2.s3)(BOOLEAN)      |my_compare(root.udf.d2.s1, root.udf.d2.s4)(BOOLEAN)      |my_compare(root.udf.d2.s1, root.udf.d2.s5)(BOOLEAN)      |my_compare(root.udf.d2.s1, root.udf.d2.s6)(BOOLEAN)      |my_compare(root.udf.d2.s1, root.udf.d2.s7)(BOOLEAN)      |my_compare(root.udf.d2.s1, root.udf.d2.s1)(BOOLEAN)      |my_compare(root.udf.d2.s1, root.udf.d2.s2)(BOOLEAN)      |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |true                                                     |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5               |false                                                    |false                                                    |false                                                    |false                                                    |false                                                    |true                                                     |false                                                    |
总数目：5
}

Elapsed Time: 0.0.18

-- [1]47:select *, my_compare(s1,s2) from root.udf.d2
STRICT{
Time(TIME)      |root.udf.d2.s3(FLOAT)      |root.udf.d2.s4(DOUBLE)      |root.udf.d2.s5(BOOLEAN)      |root.udf.d2.s6(TEXT)      |root.udf.d2.s7(INT32)      |root.udf.d2.s1(INT32)      |root.udf.d2.s2(INT64)      |my_compare(root.udf.d2.s1, root.udf.d2.s2)(BOOLEAN)      |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1               |5.0                        |7.0                         |false                        |9                         |null                       |1                          |1                          |true                                                     |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
2               |4.0                        |8.0                         |true                         |1                         |null                       |2                          |4                          |false                                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
3               |4.0                        |4.0                         |true                         |1                         |null                       |2                          |43                         |false                                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
4               |6.0                        |0.0                         |false                        |1                         |null                       |2                          |4                          |false                                                    |
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
5               |4.0                        |8.0                         |false                        |0                         |null                       |2                          |4                          |false                                                    |
总数目：5
}

Elapsed Time: 0.0.7
-- [1]48:select s1, my_compare(*) from root.udf.d2
STRICT{
SQLSTATE : 301: Index out of bound error!
}
-- [1]52:drop function my_compare
STRICT{
PASS
}
